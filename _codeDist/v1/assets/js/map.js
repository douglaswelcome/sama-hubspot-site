var offices={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[-122.419532,37.764734]},properties:{phoneFormatted:"xxxxxxxxxx",phone:"xxxxxxxxxx",suite:"Suite 301",address:"2017 Mission St",city:"San Francisco",country:"United States",crossStreet:"at 16th Street",postalCode:"94110",state:"CA"}}]};buildOfficeList(offices),mapboxgl.accessToken="pk.eyJ1IjoiZHdlbGNvbWUiLCJhIjoiY2p6MXNkdmZiMGF3OTNibzFoMm1ocG05cSJ9.xZ8njmOGIVM4sLRiit4xdg";var map=new mapboxgl.Map({container:"map",style:"mapbox://styles/dwelcome/cjz1t5chs2trc1cqmuyt3ut8d",center:[-24.547817,36.980944],zoom:1});function flyToStore(e){map.flyTo({center:e.geometry.coordinates,zoom:11.5})}function flyToDefault(){map.flyTo({center:[-24.547817,36.980944],zoom:1});var e=document.getElementsByClassName("mapboxgl-popup");e[0]&&e[0].remove()}function createPopUp(e){removePopup();new mapboxgl.Popup({closeOnClick:!1}).setLngLat(e.geometry.coordinates).setHTML('<h6 class="bold">Samasource<h6><h6>'+e.properties.city+"</h6>").addTo(map)}function removePopup(){var e=document.getElementsByClassName("mapboxgl-popup");e[0]&&e[0].remove()}function bombActive(){var e=document.getElementsByClassName("active");e[0]&&e[0].classList.remove("active")}function buildOfficeList(e){for(i=0;i<e.features.length;i++){var t=e.features[i].properties,o=document.getElementById("listings").appendChild(document.createElement("div"));o.className="locations__item",o.id="listing-"+i;var a=o.appendChild(document.createElement("a"));a.href="javascript:void();",a.className="locations__office-link",a.dataPosition=i,a.innerHTML='<span class="locations__office-title"><h2>'+t.city+"</h2></span>",a.addEventListener("click",(function(t){var o=e.features[this.dataPosition];flyToStore(o),createPopUp(o);var a=document.getElementsByClassName("active");a[0]&&a[0].classList.remove("active"),this.parentNode.classList.add("active")}))}}map.addControl(new mapboxgl.NavigationControl({showCompass:!1})),map.on("load",(function(e){map.addSource("places",{type:"geojson",data:offices})})),offices.features.forEach((function(e,t){var o=document.createElement("div");o.className="map-baby__marker",o.id="marker-"+t,new mapboxgl.Marker(o,{offset:[0,-23]}).setLngLat(e.geometry.coordinates).addTo(map),o.addEventListener("click",(function(o){flyToStore(e),createPopUp(e);var a=document.getElementsByClassName("active");o.stopPropagation(),a[0]&&a[0].classList.remove("active"),document.getElementById("listing-"+t).classList.add("active")})),o.addEventListener("mouseenter",(function(t){createPopUp(e)}))})),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),map.on("click",(function(e){var t=map.queryRenderedFeatures(e.point,{layers:["locations"]});if(t.length){var o=t[0];flyToStore(o),createPopUp(o),bombActive();for(var a=o.properties.address,s=0;s<stores.features.length;s++)stores.features[s].properties.address===a&&(selectedFeatureIndex=s);document.getElementById("listing-"+selectedFeatureIndex).classList.add("active")}})),window.onload=function(){document.getElementById("globe").onclick=function(){flyToDefault(),bombActive()}};